Create a PowerShell deployment script in the deploy-infra folder that automates the complete infrastructure deployment process. The script should be named deploy.ps1 and handle the following:

Parameters:
- ResourceGroup (required): Name of the Azure resource group
- Location (required): Azure region for deployment
- BaseName (optional, default "expensemgmt"): Prefix for resource naming
- DeployGenAI (switch): Flag to deploy Azure OpenAI and AI Search resources
- SkipDatabaseSetup (switch): Flag to skip database configuration steps for redeployments

The script should perform these steps in order:

1. Validate prerequisites - check Azure CLI is installed and user is logged in
2. Get the current user's Azure AD Object ID and User Principal Name automatically
3. Create the resource group if it doesn't exist
4. Deploy infrastructure via Bicep using the main.bicep template
5. Retrieve deployment outputs (SQL server name, web app name, managed identity, etc.)
6. Wait 30 seconds for SQL Server to be ready
7. Add the current machine's IP to the SQL Server firewall
8. Import the database schema from Database-Schema/database_schema.sql using sqlcmd with ActiveDirectoryDefault authentication
9. Configure managed identity database roles (db_datareader, db_datawriter, EXECUTE permission)
10. Create stored procedures from stored-procedures.sql
11. Configure App Service settings including Application Insights connection string
12. If GenAI is deployed, also configure OpenAI endpoint, deployment name, Search endpoint, and ManagedIdentityClientId

The script should:
- Use colored output with clear step indicators for progress tracking
- Handle errors gracefully and provide meaningful error messages
- Support idempotent execution where possible (check for existing resources)
- Include comprehensive help documentation using PowerShell comment-based help
- Print a summary of deployed resources at the end including the web app URL

Example usage:
- Basic deployment: .\deploy.ps1 -ResourceGroup "rg-expensemgmt-demo" -Location "uksouth"
- With GenAI: .\deploy.ps1 -ResourceGroup "rg-expensemgmt-demo" -Location "uksouth" -DeployGenAI
- Redeployment: .\deploy.ps1 -ResourceGroup "rg-expensemgmt-demo" -Location "uksouth" -SkipDatabaseSetup
